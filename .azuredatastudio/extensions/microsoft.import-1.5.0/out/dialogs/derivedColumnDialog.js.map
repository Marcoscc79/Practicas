{"version":3,"file":"derivedColumnDialog.js","sourceRoot":"../../src","sources":["dialogs/derivedColumnDialog.ts"],"names":[],"mappings":"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","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the Source EULA. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport * as azdata from 'azdata';\nimport { ImportDataModel } from '../wizard/api/models';\nimport * as EventEmitter from 'events';\nimport { FlatFileProvider } from '../services/contracts';\nimport * as constants from '../common/constants';\n\nconst headerLeft: azdata.CssStyles = {\n\t'border': 'none',\n\t'text-align': 'left',\n\t'white-space': 'nowrap',\n\t'text-overflow': 'ellipsis',\n\t'overflow': 'hidden',\n\t'border-bottom': '2px solid'\n};\n\nconst styleLeft: azdata.CssStyles = {\n\t'border': 'none',\n\t'text-align': 'left',\n\t'white-space': 'nowrap',\n\t'text-overflow': 'ellipsis',\n\t'overflow': 'hidden',\n};\n\nexport class DerivedColumnDialog {\n\tprivate _dialogObject: azdata.window.Dialog;\n\tprivate _doneEmitter: EventEmitter = new EventEmitter();\n\tprivate _currentTransformation: string[] = [];\n\tprivate _currentDerivedColumnName!: string;\n\tprivate _view!: azdata.ModelView;\n\tprivate _specifyTransformations: azdata.InputBoxComponent[] = [];\n\tprivate _headerInstructionText: azdata.TextComponent;\n\tprivate _bodyInstructionText: azdata.TextComponent;\n\n\tprivate _applyButton!: azdata.window.Button;\n\tprivate _transformationTable!: azdata.DeclarativeTableComponent;\n\tprivate _transformationContainer!: azdata.FlexContainer;\n\tprivate _specifyDerivedColumnNameContainer!: azdata.FlexContainer;\n\n\tconstructor(private _model: ImportDataModel, private _provider: FlatFileProvider) {\n\t}\n\n\tpublic createDerivedColumn(): Promise<DerivedColumnDialogResult | undefined> {\n\t\tthis._applyButton = azdata.window.createButton(constants.previewTransformation);\n\t\tthis._applyButton.enabled = false;\n\t\tthis._dialogObject = azdata.window.createModelViewDialog(\n\t\t\tconstants.createDerivedColumn,\n\t\t\t'DerivedColumnDialog',\n\t\t\t'wide'\n\t\t);\n\t\tthis._dialogObject.customButtons = [this._applyButton];\n\t\tthis._applyButton.hidden = false;\n\n\t\tlet tab = azdata.window.createTab('');\n\t\ttab.registerContent(async (view: azdata.ModelView) => {\n\t\t\tconst columnTableData: azdata.DeclarativeTableCellValue[][] = [];\n\t\t\tthis._model.originalProseColumns.forEach(c => {\n\t\t\t\tconst tableRow: azdata.DeclarativeTableCellValue[] = [];\n\t\t\t\ttableRow.push(\n\t\t\t\t\t{ value: false, ariaLabel: constants.selectColumn(c.columnName) },\n\t\t\t\t\t{ value: c.columnName }\n\t\t\t\t);\n\t\t\t\tcolumnTableData.push(tableRow);\n\t\t\t});\n\t\t\tthis._view = view;\n\t\t\tconst columnTable = view.modelBuilder.declarativeTable().withProps({\n\t\t\t\tcolumns: [\n\t\t\t\t\t{\n\t\t\t\t\t\tdisplayName: '',\n\t\t\t\t\t\tariaLabel: constants.selectAllColumns,\n\t\t\t\t\t\tvalueType: azdata.DeclarativeDataType.boolean,\n\t\t\t\t\t\tisReadOnly: false,\n\t\t\t\t\t\tshowCheckAll: true,\n\t\t\t\t\t\twidth: '20px',\n\t\t\t\t\t\theaderCssStyles: headerLeft,\n\t\t\t\t\t\trowCssStyles: styleLeft,\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tdisplayName: constants.columnTableTitle,\n\t\t\t\t\t\tvalueType: azdata.DeclarativeDataType.string,\n\t\t\t\t\t\tisReadOnly: true,\n\t\t\t\t\t\twidth: '140px',\n\t\t\t\t\t\theaderCssStyles: headerLeft,\n\t\t\t\t\t\trowCssStyles: styleLeft,\n\t\t\t\t\t\tariaLabel: constants.columnTableTitle\n\t\t\t\t\t}\n\t\t\t\t],\n\t\t\t\tdataValues: columnTableData,\n\t\t\t\tCSSStyles: {\n\t\t\t\t\t'table-layout': 'fixed'\n\t\t\t\t}\n\t\t\t}).component();\n\n\n\t\t\tcolumnTable.onDataChanged(e => {\n\t\t\t\tif (e.value) {\n\t\t\t\t\t// Adding newly selected column to transformation table\n\t\t\t\t\tthis._transformationTable.columns.push({\n\t\t\t\t\t\tdisplayName: this._model.proseColumns[e.row].columnName,\n\t\t\t\t\t\tvalueType: azdata.DeclarativeDataType.string,\n\t\t\t\t\t\tisReadOnly: true,\n\t\t\t\t\t\twidth: '100px',\n\t\t\t\t\t\theaderCssStyles: headerLeft,\n\t\t\t\t\t\trowCssStyles: styleLeft\n\t\t\t\t\t});\n\n\t\t\t\t\tthis._model.proseDataPreview.forEach((v, i) => {\n\t\t\t\t\t\tthis._transformationTable.dataValues[i].push({ value: v[e.row] });\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\t// Removing unselected column from transformation table\n\t\t\t\t\tlet removeIndex = this._transformationTable.columns.findIndex(v => this._model.proseColumns[e.row].columnName === v.displayName);\n\t\t\t\t\tthis._transformationTable.columns.splice(removeIndex, 1);\n\t\t\t\t\tfor (let index = 0; index < this._model.proseDataPreview.length; index++) {\n\t\t\t\t\t\tthis._transformationTable.dataValues[index].splice(removeIndex, 1);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tconst isColumnAdded = this._transformationTable.columns.length > 1;\n\t\t\t\tthis.clearAndAddTransformationContainerComponents(isColumnAdded);\n\t\t\t\tthis._applyButton.enabled = isColumnAdded;\n\t\t\t});\n\n\n\t\t\tconst columnContainer = view.modelBuilder.flexContainer().withLayout({\n\t\t\t\tflexFlow: 'column',\n\t\t\t\theight: '100%'\n\t\t\t}).withProps({\n\t\t\t\tCSSStyles: {\n\t\t\t\t\t'border-right': 'solid 1px'\n\t\t\t\t}\n\t\t\t}).component();\n\t\t\tcolumnContainer.addItem(columnTable, { flex: '1 1 auto', CSSStyles: { 'overflow-y': 'hidden' } });\n\n\t\t\tconst transformationTableData: azdata.DeclarativeTableCellValue[][] = [];\n\t\t\tfor (let index = 0; index < this._model.proseDataPreview.length; index++) {\n\t\t\t\tthis._specifyTransformations.push(this._view.modelBuilder.inputBox().withProps({\n\t\t\t\t\tvalue: '',\n\t\t\t\t\tplaceHolder: constants.specifyTransformation,\n\t\t\t\t\tariaLabel: constants.specifyTransformationForRow(index)\n\t\t\t\t}).component());\n\t\t\t\ttransformationTableData.push([{\n\t\t\t\t\tvalue: this._specifyTransformations[index]\n\t\t\t\t}]);\n\t\t\t}\n\n\t\t\tthis._transformationTable = view.modelBuilder.declarativeTable().withProps({\n\t\t\t\tcolumns: [\n\t\t\t\t\t{\n\t\t\t\t\t\tdisplayName: constants.specifyTransformation,\n\t\t\t\t\t\tariaLabel: constants.specifyTransformation,\n\t\t\t\t\t\tvalueType: azdata.DeclarativeDataType.component,\n\t\t\t\t\t\tisReadOnly: false,\n\t\t\t\t\t\twidth: '200px',\n\t\t\t\t\t\theaderCssStyles: headerLeft,\n\t\t\t\t\t\trowCssStyles: styleLeft\n\t\t\t\t\t}\n\t\t\t\t],\n\t\t\t\tCSSStyles: {\n\t\t\t\t\t'table-layout': 'fixed',\n\t\t\t\t\t'overflow': 'scroll',\n\t\t\t\t},\n\t\t\t\twidth: '800px',\n\t\t\t\tdataValues: transformationTableData\n\t\t\t}).component();\n\n\t\t\tthis._applyButton.onClick(async e => {\n\t\t\t\tconst requiredColNames = this._transformationTable.columns.map(v => v.displayName);\n\t\t\t\trequiredColNames.splice(0, 1); // Removing specify transformation column\n\t\t\t\tconst transExamples: string[] = [];\n\t\t\t\tconst transExampleIndices: number[] = [];\n\n\t\t\t\t// Getting all the example transformations specified by the user\n\t\t\t\tthis._transformationTable.dataValues.forEach((v, index) => {\n\t\t\t\t\tconst example = (<azdata.InputBoxComponent>v[0].value).value as string;\n\t\t\t\t\tif (example !== '') {\n\t\t\t\t\t\ttransExamples.push(example);\n\t\t\t\t\t\ttransExampleIndices.push(index);\n\t\t\t\t\t}\n\t\t\t\t});\n\n\t\t\t\tif (transExamples.length > 0) {\n\t\t\t\t\ttry {\n\t\t\t\t\t\tconst response = await this._provider.sendLearnTransformationRequest({\n\t\t\t\t\t\t\tcolumnNames: requiredColNames,\n\t\t\t\t\t\t\ttransformationExamples: transExamples,\n\t\t\t\t\t\t\ttransformationExampleRowIndices: transExampleIndices\n\t\t\t\t\t\t});\n\t\t\t\t\t\tthis._currentTransformation = response.transformationPreview;\n\t\t\t\t\t\tthis._currentTransformation.forEach((v, i) => {\n\t\t\t\t\t\t\t(<azdata.InputBoxComponent>this._transformationTable.dataValues[i][0].value).placeHolder = v;\n\t\t\t\t\t\t});\n\t\t\t\t\t\tthis.clearAndAddTransformationContainerComponents(true);\n\t\t\t\t\t} catch (e) {\n\t\t\t\t\t\tthis._dialogObject.message = {\n\t\t\t\t\t\t\ttext: e.toString(),\n\t\t\t\t\t\t\tlevel: azdata.window.MessageLevel.Error\n\t\t\t\t\t\t};\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tthis.validatePage();\n\t\t\t});\n\n\t\t\tconst columnNameText = view.modelBuilder.text().withProps({\n\t\t\t\tvalue: constants.specifyDerivedColNameTitle,\n\t\t\t\trequiredIndicator: true,\n\t\t\t\tCSSStyles: {\n\t\t\t\t\t'font-size': '13px',\n\t\t\t\t\t'font-weight': 'bold'\n\t\t\t\t}\n\t\t\t}).component();\n\n\t\t\tconst columnNameInput = view.modelBuilder.inputBox().withProps({\n\t\t\t\tariaLabel: constants.specifyDerivedColNameTitle,\n\t\t\t\trequired: true\n\t\t\t}).component();\n\n\t\t\tcolumnNameInput.onTextChanged(e => {\n\t\t\t\tif (e) {\n\t\t\t\t\tthis._currentDerivedColumnName = e;\n\t\t\t\t\tthis.validatePage();\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tthis._specifyDerivedColumnNameContainer = view.modelBuilder.flexContainer().withItems([\n\t\t\t\tcolumnNameText,\n\t\t\t\tcolumnNameInput\n\t\t\t]).withLayout({\n\t\t\t\twidth: '500px'\n\t\t\t}).component();\n\n\t\t\tthis._transformationContainer = view.modelBuilder.flexContainer().withLayout({\n\t\t\t\tflexFlow: 'column',\n\t\t\t\theight: '100%',\n\t\t\t}).withProps({\n\t\t\t\tCSSStyles: {\n\t\t\t\t\t'overflow-y': 'auto',\n\t\t\t\t\t'margin-left': '10px',\n\t\t\t\t}\n\t\t\t}).component();\n\n\t\t\tthis._headerInstructionText = this._view.modelBuilder.text()\n\t\t\t\t.withProps({\n\t\t\t\t\tvalue: constants.headerIntructionText,\n\t\t\t\t\tCSSStyles: {\n\t\t\t\t\t\t'font-size': 'x-large',\n\t\t\t\t\t\t'line-height': '22pt',\n\t\t\t\t\t\t'margin-bottom': '0.7em'\n\t\t\t\t\t}\n\t\t\t\t}).component();\n\n\t\t\tthis._bodyInstructionText = this._view.modelBuilder.text()\n\t\t\t\t.withProps({\n\t\t\t\t\tvalue: [\n\t\t\t\t\t\tconstants.deriverColumnInstruction1,\n\t\t\t\t\t\tconstants.deriverColumnInstruction2,\n\t\t\t\t\t\tconstants.deriverColumnInstruction3,\n\t\t\t\t\t\tconstants.deriverColumnInstruction4,\n\t\t\t\t\t\tconstants.deriverColumnInstruction5,\n\t\t\t\t\t],\n\t\t\t\t\ttextType: azdata.TextType.OrderedList,\n\t\t\t\t\tCSSStyles: {\n\t\t\t\t\t\t'font-size': 'large',\n\t\t\t\t\t\t'line-height': '22pt',\n\t\t\t\t\t\t'margin-left': '1em',\n\t\t\t\t\t\t'margin-top': '0em'\n\t\t\t\t\t}\n\t\t\t\t}).component();\n\n\t\t\tthis.clearAndAddTransformationContainerComponents(false);\n\n\t\t\tconst flexGrid = view.modelBuilder.flexContainer().withLayout({\n\t\t\t\tflexFlow: 'row',\n\t\t\t\theight: '100%',\n\t\t\t\twidth: '100%'\n\t\t\t}).component();\n\n\t\t\t/**\n\t\t\t * Setting height of the div based on the total viewport height after removing dialog\n\t\t\t * header and footer heights. With this the div will occupy the entire page space of the dialog.\n\t\t\t */\n\t\t\tflexGrid.addItem(columnContainer, {\n\t\t\t\tflex: '0 0 auto',\n\t\t\t\tCSSStyles: {\n\t\t\t\t\t'min-height': 'calc(100vh - 160px)'\n\t\t\t\t}\n\t\t\t});\n\t\t\tflexGrid.addItem(this._transformationContainer, {\n\t\t\t\tflex: '0 0 auto',\n\t\t\t\tCSSStyles: {\n\t\t\t\t\t'overflow': 'scroll',\n\t\t\t\t\t'padding-right': '10px',\n\t\t\t\t\t'width': '900px',\n\t\t\t\t\t'max-height': 'calc(100vh - 160px)'\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tconst formBuilder = view.modelBuilder.formContainer().withFormItems(\n\t\t\t\t[\n\t\t\t\t\t{\n\t\t\t\t\t\tcomponent: flexGrid\n\t\t\t\t\t}\n\t\t\t\t],\n\t\t\t\t{\n\t\t\t\t\thorizontal: false\n\t\t\t\t}\n\t\t\t);\n\t\t\tconst form = formBuilder.withLayout({ width: '100%' }).component();\n\t\t\treturn view.initializeModel(form);\n\t\t});\n\n\t\tthis._dialogObject.okButton.onClick(e => {\n\t\t\tthis._doneEmitter.emit('done');\n\t\t});\n\n\t\tthis._dialogObject.cancelButton.onClick(e => {\n\t\t\tthis._doneEmitter.emit('close');\n\t\t});\n\n\t\tthis._dialogObject.content = [tab];\n\t\tazdata.window.openDialog(this._dialogObject);\n\t\treturn new Promise((resolve) => {\n\t\t\tthis._doneEmitter.once('done', async () => {\n\t\t\t\ttry {\n\t\t\t\t\tawait this._provider.sendSaveTransformationRequest({\n\t\t\t\t\t\tderivedColumnName: this._currentDerivedColumnName\n\t\t\t\t\t});\n\t\t\t\t\tresolve({\n\t\t\t\t\t\tderivedColumnName: this._currentDerivedColumnName,\n\t\t\t\t\t\tderivedColumnDataPreview: this._currentTransformation\n\t\t\t\t\t});\n\t\t\t\t} catch (e) {\n\t\t\t\t\tconsole.log(e); // Need to have better error handling for saved transformation.However this seems to be mostly a non-issue.\n\n\t\t\t\t\tresolve(undefined);\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tthis._doneEmitter.once('close', async () => {\n\t\t\t\tresolve(undefined);\n\t\t\t});\n\t\t});\n\t}\n\n\tprivate clearAndAddTransformationContainerComponents(addTable: boolean): void {\n\t\tthis._transformationContainer.clearItems();\n\t\tif (addTable) {\n\t\t\tthis._transformationContainer.addItem(this._specifyDerivedColumnNameContainer, { flex: '0 0 auto' });\n\t\t\tthis._transformationContainer.addItem(this._transformationTable, { flex: '1 1 auto', CSSStyles: { 'overflow': 'scroll' } });\n\t\t}\n\t\telse {\n\t\t\tthis._transformationContainer.addItem(this._headerInstructionText, { flex: '0 0 auto' });\n\t\t\tthis._transformationContainer.addItem(this._bodyInstructionText, { flex: '0 0 auto' });\n\t\t}\n\t}\n\n\tprivate validatePage(): void {\n\t\tthis._dialogObject.okButton.enabled = this._currentDerivedColumnName !== undefined && this._currentTransformation.length !== 0;\n\t}\n}\n\nexport interface DerivedColumnDialogResult {\n\tderivedColumnName?: string;\n\tderivedColumnDataPreview?: string[];\n}\n"]}