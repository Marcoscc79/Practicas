{"version":3,"file":"modifyColumnsPage.js","sourceRoot":"../../../src","sources":["wizard/pages/modifyColumnsPage.ts"],"names":[],"mappings":"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","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the Source EULA. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport * as azdata from 'azdata';\nimport { ColumnMetadata, ColumnMetadataArray } from '../api/models';\nimport { ImportPage } from '../api/importPage';\nimport * as constants from '../../common/constants';\n\nexport class ModifyColumnsPage extends ImportPage {\n\tprivate readonly categoryValues = [\n\t\t{ name: 'bigint', displayName: 'bigint' },\n\t\t{ name: 'binary(50)', displayName: 'binary(50)' },\n\t\t{ name: 'bit', displayName: 'bit' },\n\t\t{ name: 'char(10)', displayName: 'char(10)' },\n\t\t{ name: 'date', displayName: 'date' },\n\t\t{ name: 'datetime', displayName: 'datetime' },\n\t\t{ name: 'datetime2(7)', displayName: 'datetime2(7)' },\n\t\t{ name: 'datetimeoffset(7)', displayName: 'datetimeoffset(7)' },\n\t\t{ name: 'decimal(18, 10)', displayName: 'decimal(18, 10)' },\n\t\t{ name: 'float', displayName: 'float' },\n\t\t{ name: 'geography', displayName: 'geography' },\n\t\t{ name: 'geometry', displayName: 'geometry' },\n\t\t{ name: 'hierarchyid', displayName: 'hierarchyid' },\n\t\t{ name: 'int', displayName: 'int' },\n\t\t{ name: 'money', displayName: 'money' },\n\t\t{ name: 'nchar(10)', displayName: 'nchar(10)' },\n\t\t{ name: 'ntext', displayName: 'ntext' },\n\t\t{ name: 'numeric(18, 0)', displayName: 'numeric(18, 0)' },\n\t\t{ name: 'nvarchar(50)', displayName: 'nvarchar(50)' },\n\t\t{ name: 'nvarchar(MAX)', displayName: 'nvarchar(MAX)' },\n\t\t{ name: 'real', displayName: 'real' },\n\t\t{ name: 'smalldatetime', displayName: 'smalldatetime' },\n\t\t{ name: 'smallint', displayName: 'smallint' },\n\t\t{ name: 'smallmoney', displayName: 'smallmoney' },\n\t\t{ name: 'sql_variant', displayName: 'sql_variant' },\n\t\t{ name: 'text', displayName: 'text' },\n\t\t{ name: 'time(7)', displayName: 'time(7)' },\n\t\t{ name: 'timestamp', displayName: 'timestamp' },\n\t\t{ name: 'tinyint', displayName: 'tinyint' },\n\t\t{ name: 'uniqueidentifier', displayName: 'uniqueidentifier' },\n\t\t{ name: 'varbinary(50)', displayName: 'varbinary(50)' },\n\t\t{ name: 'varbinary(MAX)', displayName: 'varbinary(MAX)' },\n\t\t{ name: 'varchar(50)', displayName: 'varchar(50)' },\n\t\t{ name: 'varchar(MAX)', displayName: 'varchar(MAX)' }\n\t];\n\n\tprivate _table: azdata.DeclarativeTableComponent;\n\tprivate _loading: azdata.LoadingComponent;\n\tprivate _text: azdata.TextComponent;\n\tprivate _form: azdata.FormContainer;\n\n\tpublic get table(): azdata.DeclarativeTableComponent {\n\t\treturn this._table;\n\t}\n\n\tpublic set table(table: azdata.DeclarativeTableComponent) {\n\t\tthis._table = table;\n\t}\n\n\tpublic get loading(): azdata.LoadingComponent {\n\t\treturn this._loading;\n\t}\n\n\tpublic set loading(loading: azdata.LoadingComponent) {\n\t\tthis._loading = loading;\n\t}\n\n\tpublic get text(): azdata.TextComponent {\n\t\treturn this._text;\n\t}\n\n\tpublic set text(text: azdata.TextComponent) {\n\t\tthis._text = text;\n\t}\n\n\tpublic get form(): azdata.FormContainer {\n\t\treturn this._form;\n\t}\n\n\tpublic set form(form: azdata.FormContainer) {\n\t\tthis._form = form;\n\t}\n\n\tprivate static convertMetadata(column: ColumnMetadata): any[] {\n\t\treturn [column.columnName, column.dataType, false, column.nullable];\n\t}\n\n\tasync start(): Promise<boolean> {\n\t\tthis.loading = this.view.modelBuilder.loadingComponent().component();\n\t\tthis.table = this.view.modelBuilder.declarativeTable().component();\n\t\tthis.text = this.view.modelBuilder.text().component();\n\n\t\tthis.table.onDataChanged((e) => {\n\t\t\tthis.model.proseColumns = [];\n\t\t\tthis.table.data.forEach((row) => {\n\t\t\t\tthis.model.proseColumns.push({\n\t\t\t\t\tcolumnName: row[0].value,\n\t\t\t\t\tdataType: row[1].value,\n\t\t\t\t\tprimaryKey: row[2].value,\n\t\t\t\t\tnullable: row[3].value\n\t\t\t\t});\n\t\t\t});\n\t\t});\n\n\t\tthis.form = this.view.modelBuilder.formContainer()\n\t\t\t.withFormItems(\n\t\t\t\t[\n\t\t\t\t\t{\n\t\t\t\t\t\tcomponent: this.text,\n\t\t\t\t\t\ttitle: ''\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tcomponent: this.table,\n\t\t\t\t\t\ttitle: ''\n\t\t\t\t\t}\n\t\t\t\t], {\n\t\t\t\thorizontal: false,\n\t\t\t\tcomponentWidth: '100%'\n\t\t\t}).component();\n\n\t\tthis.loading.component = this.form;\n\t\tawait this.view.initializeModel(this.form);\n\t\treturn true;\n\t}\n\n\tasync onPageEnter(): Promise<boolean> {\n\t\tthis.loading.loading = true;\n\t\tawait this.populateTable();\n\t\tthis.instance.changeNextButtonLabel(constants.importDataText);\n\t\tthis.loading.loading = false;\n\t\tthis.instance.registerNavigationValidator((info) => {\n\t\t\treturn this.table.data && this.table.data.length > 0;\n\t\t});\n\t\treturn true;\n\t}\n\n\toverride async onPageLeave(): Promise<boolean> {\n\t\tawait this.emptyTable();\n\t\tthis.instance.changeNextButtonLabel(constants.nextText);\n\t\tthis.instance.registerNavigationValidator((info) => {\n\t\t\treturn true;\n\t\t});\n\t\treturn undefined;\n\t}\n\n\tprivate emptyTable() {\n\t\tthis.table.updateProperties({\n\t\t\tdata: [],\n\t\t\tcolumns: []\n\t\t});\n\t}\n\n\toverride async cleanup(): Promise<boolean> {\n\t\tdelete this.model.proseColumns;\n\t\tthis.instance.changeNextButtonLabel(constants.nextText);\n\n\t\treturn true;\n\t}\n\n\tprivate async populateTable() {\n\t\tlet data: ColumnMetadataArray[] = [];\n\n\t\tthis.model.proseColumns.forEach((column) => {\n\t\t\tdata.push(ModifyColumnsPage.convertMetadata(column));\n\t\t});\n\n\t\tthis.table.updateProperties({\n\t\t\tcolumns: [{\n\t\t\t\tdisplayName: constants.columnNameText,\n\t\t\t\tvalueType: azdata.DeclarativeDataType.string,\n\t\t\t\twidth: '150px',\n\t\t\t\tisReadOnly: false\n\t\t\t}, {\n\t\t\t\tdisplayName: constants.dataTypeText,\n\t\t\t\tvalueType: azdata.DeclarativeDataType.editableCategory,\n\t\t\t\twidth: '150px',\n\t\t\t\tisReadOnly: false,\n\t\t\t\tcategoryValues: this.categoryValues\n\t\t\t}, {\n\t\t\t\tdisplayName: constants.primaryKeyText,\n\t\t\t\tvalueType: azdata.DeclarativeDataType.boolean,\n\t\t\t\twidth: '100px',\n\t\t\t\tisReadOnly: false,\n\t\t\t\tshowCheckAll: true\n\t\t\t}, {\n\t\t\t\tdisplayName: constants.allowNullsText,\n\t\t\t\tvalueType: azdata.DeclarativeDataType.boolean,\n\t\t\t\tisReadOnly: false,\n\t\t\t\twidth: '100px',\n\t\t\t\tshowCheckAll: true\n\t\t\t}],\n\t\t\tdata: data\n\t\t});\n\t}\n}\n"]}